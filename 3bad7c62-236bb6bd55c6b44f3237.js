(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{EFQ4:function(e,t,n){var r,i,o,a,u,s,c,l,f,v,h,p,d,m,g,y,b,x,_=n("PJYZ"),k=n("7W2i"),w=n("a1gu"),S=n("Nsbk"),j=n("oShl"),A=n("QILm"),E=n("SA+Z"),z=n("VkAN"),T=n("RIqP"),P=n("J4zp"),R=n("lwsE"),M=n("W8MJ"),N=["context","grid","position","shuffle"];function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return w(this,n)}}function O(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n("E9XD"),n("XbcX"),n("c9m3"),n("7ueG"),n("IZzc"),function(e){"use strict";var t=[":",";",",","(",")","[","]","{","}","π","±","+","-","*","/","%",'"',"'","`","@"],n={escape:function(e){return"\\"==e},space:function(e){return/[\r\n\t\s]/.test(e)},digit:function(e){return/^[0-9]$/.test(e)},sign:function(e){return/^[+-]$/.test(e)},dot:function(e){return"."==e},quote:function(e){return/^["'`]$/.test(e)},symbol:function(e){return t.includes(e)},hexNum:function(e){return/^[0-9a-f]$/i.test(e)},hex:function(e,t,r){return"0"==e&&n.letter(t,"x")&&n.hexNum(r)},expWithSign:function(e,t,r){return n.letter(e,"e")&&n.sign(t)&&n.digit(r)},exp:function(e,t){return n.letter(e,"e")&&n.digit(t)},dots:function(e,t){return n.dot(e)&&n.dot(t)},letter:function(e,t){return String(e).toLowerCase()==String(t).toLowerCase()},comment:function(e,t){return"/"==e&&"*"==t},selfClosedTag:function(e,t){return"/"==e&&">"==t},closedTag:function(e,t){return"<"==e&&"/"==t}},w=function(){function e(t){var n=t.type,r=t.value,i=t.pos,o=t.status;R(this,e),this.type=n,this.value=r,this.pos=i,o&&(this.status=o)}return M(e,[{key:"isSymbol",value:function(){for(var e=this,t="Symbol"==this.type,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length?r.some((function(t){return t===e.value})):t}},{key:"isSpace",value:function(){return"Space"==this.type}},{key:"isNumber",value:function(){return"Number"==this.type}},{key:"isWord",value:function(){return"Word"==this.type}}]),e}();function S(e){var t=-1,n=e.length,r=-1,i=0;return{curr:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e[t+n]},next:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=e[t+=n];return"\n"==o?(i++,r=0):r+=n,o},end:function(){return t>=n},get:function(){return{prev:e[t-1],curr:e[t+0],next:e[t+1],next2:e[t+2],next3:e[t+3],pos:[r,i]}}}}function I(e){for(;e.next();){var t=e.get(),r=t.curr,i=t.prev;if(n.comment(r,i))break}}function L(e){return[":",";",",","{","}","(",")","[","]"].includes(e)}function W(e){for(var t="";!e.end();){var r=e.get(),i=r.curr,o=r.next;t+=i;var a=n.symbol(o)||n.space(o)||n.digit(o);if(t.length&&a&&!n.closedTag(i,o))break;e.next()}return t.trim()}function U(e){for(var t="";!e.end();){var r=e.get(),i=r.curr,o=r.next;if(t+=i,!n.space(o))break;e.next()}return t}function X(e){for(var t="",r=!1;!e.end();){var i=e.get(),o=i.curr,a=i.next,u=i.next2,s=i.next3;if(t+=o,r&&n.dot(a))break;if(n.dot(o)&&(r=!0),n.dots(a,u))break;if(n.expWithSign(a,u,s))t+=e.next()+e.next();else if(n.exp(a,u))t+=e.next();else if(!n.digit(a)&&!n.dot(a))break;e.next()}return t}function $(e){var t="0x";for(e.next(2);!e.end();){var r=e.get(),i=r.curr,o=r.next;if(t+=i,!n.hexNum(o))break;e.next()}return t}function D(e){return e[e.length-1]}function B(e){for(var t=S(String(e).trim()),r=[],i=[];t.next();){var o=t.get(),a=o.prev,u=o.curr,s=o.next,c=o.next2,l=o.pos;if(n.comment(u,s))I(t);else if(n.hex(u,s,c)){var f=$(t);r.push(new w({type:"Number",value:f,pos:l}))}else if(n.digit(u)||n.digit(s)&&n.dot(u)&&!n.dots(a,u)){var v=X(t);r.push(new w({type:"Number",value:v,pos:l}))}else if(n.symbol(u)&&!n.selfClosedTag(u,s)){var h=D(r),p=n.digit(s)||n.dot(s)&&n.digit(c);if("-"===u&&p&&(!h||!h.isNumber())){var d=X(t);r.push(new w({type:"Number",value:d,pos:l}));continue}var m={type:"Symbol",value:u,pos:l};if(i.length&&n.escape(h.value)){r.pop();var g=W(t);g.length&&r.push(new w({type:"Word",value:g,pos:l}))}else n.quote(u)&&(D(i)==u?(i.pop(),m.status="close"):(i.push(u),m.status="open")),r.push(new w(m))}else if(n.space(u)){var y=U(t),b=D(r),x=t.get().next;if(!i.length&&b){var _=b.value,k=L(_)&&")"!==_,j=L(x)&&"("!==x;if(k||j)continue;y=" "}r.length&&x&&x.trim()&&r.push(new w({type:"Space",value:y,pos:l}))}else{var A=W(t);A.length&&r.push(new w({type:"Word",value:A,pos:l}))}}var E=D(r);return E&&E.isSpace()&&(r.length=r.length-1),r}function H(e){for(var t=[];e.next();){var n=e.get(),r=n.curr,i=n.next;if("var"===r.value){if(i&&i.isSymbol("(")){e.next();var o=F(e);void 0!==(a=o.name)&&!(a.length<=2)&&!a.substr(2).startsWith("-")&&a.startsWith("--")&&t.push(o)}}else if(t.length&&!r.isSymbol(","))break}var a;return t}function F(e){for(var t={},n=[];e.next();){var r=e.get(),i=r.curr;if(r.next,i.isSymbol(")",";")&&!t.name){t.name=q(n);break}i.isSymbol(",")?(void 0===t.name&&(t.name=q(n),n=[]),t.name&&(t.fallback=H(e))):n.push(i)}return t}function q(e){return e.map((function(e){return e.value})).join("")}function Y(e,t,n){return e=Number(e)||0,Math.max(t,Math.min(n,e))}function V(e,t){return e?"function"==typeof t?t():t:""}function Z(e,t,n){var r=0,i=e,o=function(e){return e>0&&e<1?.1:1},a=arguments.length;if(1==a){var u=[o(e),e];e=u[0],t=u[1]}a<3&&(n=o(e));for(var s=[];(n>=0&&e<=t||n<0&&e>t)&&(s.push(e),e+=n,!(r++>=1e3)););return s.length||s.push(i),s}function G(e,t){for(var n=0,r=Object.entries(t);n<r.length;n++){var i=P(r[n],2),o=i[0],a=i[1];e[o]=e[a]}return e}function J(e){return/^[a-zA-Z]$/.test(e)}function K(e){return null==e}function Q(e){return K(e)||Number.isNaN(e)}function ee(e){return K(e)||""===e}function te(e){var t=function(){return e};return t.lazy=!0,t}function ne(e,t){for(var n=String(e).split("x"),r=P(n,2),i=r[0],o=r[1],a=void 0===o?1:o,u=(i=Y(Math.ceil(i)||1,1,65536))*(a=Y(Math.ceil(a)||1,1,65536)),s=[],c=1,l=1;l<=a;++l)for(var f=1;f<=i;++f)s.push(t(c++,f,l,u,i,a));return s}function re(e,t,n){return"c-"+e+"-"+t+"-"+n}function ie(e){for(var t=e;t&&!K(t.value);)t=t.value;return K(t)?"":t}function oe(e){return(K(e)?Date.now():String(e).replace(/\/.png$/g,""))+".png"}function ae(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new Image;r.crossOrigin="anonymous",r.src=e,r.onload=function(){setTimeout(t,n)}}function ue(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function se(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}function ce(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function le(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=3735928559^n,i=1103547991^n,o=0;o<e.length;o++)t=e.charCodeAt(o),r=Math.imul(r^t,2654435761),i=Math.imul(i^t,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),4294967296*(2097151&(i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909)))+(r>>>0)}function fe(e){var t=function(e){return K(e)?"":e};return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=n.reduce((function(e,n,r){return e+n+t(i[r])}),"");return e(a)}}function ve(){var e=0;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(t,"-").concat(++e)}}function he(e,t,n){return t+e*(n-t)}function pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e+Math.random().toString(32).substr(2)}function de(e){return Array.isArray(e)?e:[e]}function me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\n";return(e||[]).join(t)}function ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return K(e)?"":e[e.length-t]}function ye(e){return e[0]}function be(e,t){return Array.prototype.flatMap?e.flatMap(t):e.reduce((function(e,n){return e.concat(t(n))}),[])}var xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"func",name:e,arguments:[]}},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"text",value:e}},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"pseudo",selector:e,styles:[]}},we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"cond",name:e,styles:[],arguments:[]}},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"rule",property:e,value:[]}},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"keyframes",name:e,steps:[]}},Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"step",name:e,styles:[]}},Ee=function(e){return/[\s\n\t]/.test(e)},ze=function(e){return/\n/.test(e)},Te=function(e){return!isNaN(e)},Pe=function(e,t){return{'"':'"',"'":"'","(":")"}[e]==t},Re={"π":Math.PI,"∏":Math.PI};function Me(e){return["@canvas","@shaders","@doodle"].includes(e)}function Ne(e){return function(t,n){for(var r=t.index(),i="";!t.end();){var o=t.next();if(e(o))break;i+=o}return n&&t.index(r),i}}function Ce(e,t){return Ne((function(e){return/[^\w@]/.test(e)}))(e,t)}function Oe(e){return Ne((function(e){return/[\s\{]/.test(e)}))(e)}function Ie(e,t){return Ne((function(e){return ze(e)||"{"==e}))(e,t)}function Le(e,t){for(var n,r=Ae();!e.end()&&"}"!=(n=e.curr());)if(Ee(n))e.next();else{if(r.name.length){if(r.styles.push(Ge(e,t)),"}"==e.curr())break}else r.name=Ye(e);e.next()}return r}function We(e,t){for(var n,r=[];!e.end()&&"}"!=(n=e.curr());)Ee(n)||r.push(Le(e,t)),e.next();return r}function Ue(e,t){for(var n,r,i,o,a,u=je();!e.end()&&"}"!=(n=e.curr());)if(u.name.length){if("{"==n||"{"==e.curr(-1)){e.next(),u.steps=We(e,t);break}e.next()}else if(Ce(e),u.name=Oe(e),!u.name.length){r="missing keyframes name",i=e.info(),o=void 0,a=void 0,o=i.col,a=i.line,console.warn("(at line ".concat(a,", column ").concat(o,") ").concat(r));break}return u}function Xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(e.next();!e.end();){var n=e.curr();if(t.inline){if("\n"==n)break}else if("*"==(n=e.curr())&&"/"==e.curr(1))break;e.next()}t.inline||(e.next(),e.next())}function $e(e){for(e.next();!e.end()&&">"!=e.curr();)e.next()}function De(e){for(var t,n="";!e.end()&&":"!=(t=e.curr());)Ee(t)||(n+=t),e.next();return n}function Be(e,t,n){for(var r,i,o,a=[],u=[],s=[],c="";!e.end();){if(r=e.curr(),/[\('"`]/.test(r)&&"\\"!==e.curr(-1))s.length&&"("!=r&&r===ge(s)?s.pop():s.push(r),c+=r;else if("@"!=r||n)if(n&&/[)]/.test(r)||!n&&/[,)]/.test(r))if(s.length)")"==r&&s.pop(),c+=r;else{if(c.length&&(u.length?u.push(_e(c)):u.push(_e((o=c).trim().length?Te(+o)?+o:o.trim():o)),c.startsWith("±")&&!n)){var l=c.substr(1),f=(i=u,JSON.parse(JSON.stringify(i)));ge(f).value="-"+l,a.push(He(f)),ge(u).value=l}if(a.push(He(u)),u=[],c="",")"==r)break}else Re[r]&&!/[0-9]/.test(e.curr(-1))&&(r=Re[r]),c+=r;else u.length||(c=c.trimLeft()),c.length&&(u.push(_e(c)),c=""),u.push(Fe(e));if(!(!t||")"!=e.curr(1)&&/[0-9a-zA-Z_\-.]/.test(e.curr())||s.length)){u.length&&a.push(He(u));break}e.next()}return function(e){var t=ge(e[0]);return t&&"text"===t.type&&!String(t.value).trim().length&&(e[0]=e[0].slice(0,-1)),e}(a)}function He(e){var t=e.map((function(e){if("text"==e.type&&"string"==typeof e.value){var t=String(e.value);t.includes("`")&&(e.value=t=t.replace(/`/g,'"')),e.value=t}return e})),n=ye(t)||{},r=ge(t)||{};if("text"==n.type&&"text"==r.type){var i=ye(n.value),o=ge(r.value);"string"==typeof n.value&&"string"==typeof r.value&&Pe(i,o)&&(n.value=n.value.slice(1),r.value=r.value.slice(0,r.value.length-1),t.cluster=!0)}return t}function Fe(e){var t,n=xe(),r="@",i=!1;for(e.next();!e.end();){var o="."==(t=e.curr())&&"@"==e.curr(1),a=e.curr(1);if("("==t||o){i=!0,e.next(),n.arguments=Be(e,o,Me(r));break}if(!i&&"("!==a&&!/[0-9a-zA-Z_\-.]/.test(a)){r+=t;break}r+=t,e.next()}var u=function(e){var t="",n="";if(/\D$/.test(e)&&!/\d+x\d+/.test(e)||Math[e.substr(1)])return{fname:e,extra:n};for(var r=e.length-1;r>=0;r--){var i=e[r],o=e[r-1],a=e[r+1];if(!(/[\d.]/.test(i)||"x"==i&&/\d/.test(o)&&/\d/.test(a))){t=e.substring(0,r+1);break}n=i+n}return{fname:t,extra:n}}(r),s=u.fname,c=u.extra;return n.name=s,c.length&&n.arguments.unshift([{type:"text",value:c}]),n.position=e.info().index,n}function qe(e){var t,n=_e(),r=0,i=!0,o=[],a=[];for(o[r]=[];!e.end();)if(t=e.curr(),i&&Ee(t))e.next();else{if(i=!1,"\n"!=t||Ee(e.curr(-1)))if(","!=t||a.length){if(/[;}<]/.test(t)){n.value.length&&(o[r].push(n),n=_e());break}"@"==t?(n.value.length&&(o[r].push(n),n=_e()),o[r].push(Fe(e))):Ee(t)&&Ee(e.curr(-1))||("("==t&&a.push(t),")"==t&&a.pop(),Re[t]&&!/[0-9]/.test(e.curr(-1))&&(t=Re[t]),n.value+=t)}else n.value.length&&(o[r].push(n),n=_e()),o[++r]=[],i=!0;else n.value+=" ";e.next()}return n.value.length&&o[r].push(n),o}function Ye(e){for(var t,n="";!e.end()&&"{"!=(t=e.curr());)Ee(t)||(n+=t),e.next();return n}function Ve(e){for(var t,n={name:"",arguments:[]};!e.end();){if("("==(t=e.curr()))e.next(),n.arguments=Be(e);else{if(/[){]/.test(t))break;Ee(t)||(n.name+=t)}e.next()}return n}function Ze(e,t){for(var n,r=ke();!e.end();){if("/"==(n=e.curr())&&"*"==e.curr(1))Xe(e);else{if("}"==n)break;if(Ee(n)){e.next();continue}if(r.selector){var i=Ge(e,t);if("@use"==i.property?r.styles=r.styles.concat(i.value):r.styles.push(i),"}"==e.curr())break}else r.selector=Ye(e)}e.next()}return r}function Ge(e,t){for(var n,r=Se();!e.end();){if("/"==(n=e.curr())&&"*"==e.curr(1))Xe(e);else{if(";"==n)break;if(r.property.length){r.value=qe(e);break}if(r.property=De(e),"@use"==r.property){r.value=et(e,t);break}}e.next()}return r}function Je(e,t){for(var n,r=we();!e.end();){if("/"==(n=e.curr())&&"*"==e.curr(1))Xe(e);else{if("}"==n)break;if(r.name.length)if(":"==n){var i=Ze(e);i.selector&&r.styles.push(i)}else if("@"!=n||Ie(e,!0).includes(":")){if(!Ee(n)){var o=Ge(e,t);if(o.property&&r.styles.push(o),"}"==e.curr())break}}else r.styles.push(Je(e));else Object.assign(r,Ve(e))}e.next()}return r}function Ke(e,t){var n="";return e&&e.get_variable&&(n=e.get_variable(t)),n}function Qe(e,t){e.forEach&&e.forEach((function(e){if("text"==e.type&&e.value){var n=H(S(B(e.value)));e.value=n.reduce((function(e,n){var r,i="",o="";!(i=Ke(t,n.name))&&n.fallback&&n.fallback.every((function(e){if(o=Ke(t,e.name))return i=o,!1}));try{r=tt(i,t)}catch(a){}return r&&e.push.apply(e,r),e}),[])}"func"==e.type&&e.arguments&&e.arguments.forEach((function(e){Qe(e,t)}))}))}function et(e,t){return e.next(),(qe(e)||[]).reduce((function(e,n){Qe(n,t);var r=P(n,1)[0];return r.value&&r.value.length&&e.push.apply(e,T(r.value)),e}),[])}function tt(e,t){for(var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,n=1,r=1;return{curr:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e[t+n]},end:function(){return e.length<=t},info:function(){return{index:t,col:n,line:r}},index:function(e){return void 0===e?t:t=e},next:function(){var i=e[t++];return"\n"==i?(r++,n=0):n++,i}}}(e),r=[];!n.end();){var i=n.curr();if(Ee(i))n.next();else{if("/"==i&&"*"==n.curr(1))Xe(n);else if(":"==i){var o=Ze(n,t);o.selector&&r.push(o)}else if("@"==i&&"@keyframes"===Ce(n,!0)){var a=Ue(n,t);r.push(a)}else if("@"!=i||Ie(n,!0).includes(":")){if("<"==i)$e(n);else if(!Ee(i)){var u=Ge(n,t);u.property&&r.push(u)}}else{var s=Je(n,t);s.name.length&&r.push(s)}n.next()}}return r}function nt(e){var t=(e+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map((function(e){return parseInt(e)})),n=P(t,3),r=n[0],i=n[1],o=n[2],a=1==r||1==i?1024:32,u=1==r&&1==i?1024:1,s={x:Y(r||1,1,a),y:Y(i||r||1,1,a),z:Y(o||1,1,u)};return Object.assign({},s,{count:s.x*s.y*s.z,ratio:s.x/s.y})}function rt(e){return/^texture\w*$|^(fragment|vertex)$/.test(e)}function it(){return new w({type:"LineBreak",value:"\n"})}function ot(e){for(var t=e[0],n=e[e.length-1];t&&t.isSymbol("(")&&n&&n.isSymbol(")");)t=(e=e.slice(1,e.length-1))[0],n=e[e.length-1];return e}function at(e){return ot(e).map((function(e){return e.value})).join("")}function ut(e,t){var n=encodeURIComponent(e)+(t?"#".concat(t):"");return'url("data:image/svg+xml;utf8,'.concat(n,'")')}function st(e){var t='xmlns="'.concat("http://www.w3.org/2000/svg",'"'),n='xmlns:xlink="'.concat("http://www.w3.org/1999/xlink",'"');return e.includes("<svg")||(e="<svg ".concat(t," ").concat(n,">").concat(e,"</svg>")),e.includes("xmlns")||(e=e.replace(/<svg([\s>])/,"<svg ".concat(t," ").concat(n,"$1"))),e}var ct=ve(),lt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(R(this,e),!t)throw new Error("Tag name is required");this.name=t,this.body=[],this.attrs={},this.isTextNode()&&(this.body=n)}return M(e,[{key:"isTextNode",value:function(){return"text-node"===this.name}},{key:"append",value:function(e){this.isTextNode()||this.body.push(e)}},{key:"attr",value:function(e,t){if(!this.isTextNode())return void 0===t?this.attrs[e]:this.attrs[e]=t}},{key:"toString",value:function(){if(this.isTextNode())return this.body;for(var e=[""],t=[],n=0,r=Object.entries(this.attrs);n<r.length;n++){var i=P(r[n],2),o=i[0],a=i[1];e.push("".concat(o,'="').concat(a,'"'))}var u,s=O(this.body);try{for(s.s();!(u=s.n()).done;){var c=u.value;t.push(c.toString())}}catch(l){s.e(l)}finally{s.f()}return"<".concat(this.name).concat(e.join(" "),">").concat(t.join(""),"</").concat(this.name,">")}}]),e}();function ft(e,t){return"".concat(e,":").concat(t,";")}function vt(e){var t=e.value.map((function(e){return"block"===e.type?vt(e):ft(e.name,e.value)})).join("");return"".concat(e.name,"{").concat(t,"}")}function ht(e){return function e(t,n,r,i){var o;if(n||(n=new lt("root")),"block"===t.type)if("style"===t.name){if(Array.isArray(t.value)){var a,u=new lt("style"),s=[],c=O(t.value);try{for(c.s();!(a=c.n()).done;){var l=a.value;"block"===l.type&&s.push(vt(l))}}catch(_){c.e(_)}finally{c.f()}u.append(s.join("")),n.append(u)}}else{var f=new lt(t.name);i||(i=f).attr("xmlns","http://www.w3.org/2000/svg");var v,h=O(t.value);try{for(h.s();!(v=h.n()).done;){var p=e(v.value,f,t,i);p&&(o=p)}}catch(_){h.e(_)}finally{h.f()}if(t.inline){var d=t.value.find((function(e){return"statement"===e.type&&"id"===e.name}));d?o=d.value:(o=ct(t.name),f.attr("id",o))}n.append(f)}if("statement"===t.type)if(!r||"text"!==r.name&&"tspan"!==r.name||"content"!==t.name)if(t.name.startsWith("style ")){var m=(t.name.split("style ")[1]||"").trim();if(m.length){var g=n.attr("style")||"";n.attr("style",g+ft(m,t.value))}}else{var y=t.value;if(y&&"block"===y.type){var b=e(t.value,i,t,i);y="url(#".concat(b,")")}n.attr(t.name,y),t.name.includes("xlink:")&&i.attr("xmlns:xlink","http://www.w3.org/1999/xlink")}else{var x=new lt("text-node",t.value);n.append(x)}return r?o:i.toString()}(e)}function pt(e){for(var t=S(B(e)),n={},r=!1;t.next();){var i=t.get(),o=i.prev,a=i.curr;if(a.isNumber())n.value=Number(a.value),r=!0;else{if(!(r&&(a.isWord()||a.isSymbol())&&o&&o.isNumber()))break;n.unit=a.value}}return n}function dt(e){return function(){for(var t=[],n=[],r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var a=0,u=i;a<u.length;a++){var s=u[a],c=pt(s),l=c.unit,f=c.value;void 0!==l&&t.push(l),void 0!==f&&n.push(f)}var v=e.apply(void 0,n),h=t.find((function(e){return void 0!==e}));return void 0===h?v:Array.isArray(v)?v.map((function(e){return e+h})):v+h}}function mt(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.map((function(e){return String(e).charCodeAt(0)})),o=e.apply(void 0,T(i));return Array.isArray(o)?o.map((function(e){return String.fromCharCode(e)})):String.fromCharCode(o)}}var gt={"π":Math.PI,gcd:function(e,t){for(;t;){var n=[t,e%t];e=n[0],t=n[1]}return e}},yt={"^":7,"*":6,"/":6,"÷":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"≤":3,"<=":3,"≥":3,">=":3,"≠":3,"!=":3,"∧":2,"&&":2,"∨":2,"||":2,"(":1,")":1};function bt(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[];e.length;){var i=e.shift(),o=i.name,a=i.value,u=i.type;if("variable"===u){var s=t[a];Q(s)&&(s=Math[a]),Q(s)&&(s=kt(a,t)),Q(s)&&/^\-\D/.test(a)&&(s=kt("-1"+a.substr(1),t)),void 0===s&&(s=0),"number"!=typeof s&&(n.push(s),wt(n)?(s=0,n=[]):s=bt(xt(s),t,n)),r.push(s)}else if("function"===u){var c=!1;/^\-/.test(o)&&(c=!0,o=o.substr(1));for(var l=a.map((function(e){return bt(e,t)})),f=o.split("."),v=void 0;v=f.pop();)if(v){var h=t[v]||Math[v];l="function"==typeof h?Array.isArray(l)?h.apply(void 0,T(l)):h(l):0}c&&(l*=-1),r.push(l)}else if(/\d+/.test(a))r.push(a);else{var p=r.pop(),d=r.pop();r.push(_t(a,Number(d),Number(p)))}}return Number(r[0])||0}function xt(e){for(var t=function(e){for(var t=String(e),n=[],r="",i=0;i<t.length;++i){var o=t[i];if(yt[o]){var a=ge(n);if("="==o&&a&&/^[!<>=]$/.test(a.value))a.value+=o;else if(/^[|&<>]$/.test(o)&&a&&a.value==o)a.value+=o;else if("-"==o&&"e"==t[i-1])r+=o;else if(n.length||r.length||!/[+-]/.test(o)){var u=a||{},s=u.type,c=u.value;"operator"==s&&!r.length&&/[^()]/.test(o)&&/[^()]/.test(c)?r+=o:(r.length&&(n.push({type:"number",value:r}),r=""),n.push({type:"operator",value:o}))}else r+=o}else/\S/.test(o)&&(","==o?(n.push({type:"number",value:r}),r="",n.push({type:"comma",value:o})):"!"==o?(n.push({type:"number",value:r}),n.push({type:"operator",value:o}),r=""):r+=o)}return r.length&&n.push({type:"number",value:r}),n}(e),n=[],r=[],i=0;i<t.length;++i){var o=t[i],a=o.type,u=o.value,s=t[i+1]||{};if("number"==a)if("("==s.value&&/[^\d.\-]/.test(u)){var c="",l=[],f=[];for(i+=1;void 0!==t[i++];){var v=t[i];if(void 0===v)break;var h=v.value;if(")"==h){if(!l.length)break;l.pop(),c+=h}else if("("==h&&l.push(h),","!=h||l.length)c+=h;else{var p=xt(c);p.length&&f.push(p),c=""}}c.length&&f.push(xt(c)),r.push({type:"function",name:u,value:f})}else/[^\d.\-]/.test(u)?r.push({type:"variable",value:u}):r.push({type:"number",value:u});else if("operator"==a)if("("==u)n.push(u);else if(")"==u){for(;n.length&&"("!=ge(n);)r.push({type:"operator",value:n.pop()});n.pop()}else{for(;n.length&&yt[ge(n)]>=yt[u];){var d=n.pop();/[()]/.test(d)||r.push({type:"operator",value:d})}n.push(u)}}for(;n.length;)r.push({type:"operator",value:n.pop()});return r}function _t(e,t,n){switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"%":return t%n;case"|":return t|n;case"&":return t&n;case"<":return t<n;case">":return t>n;case"^":return Math.pow(t,n);case"÷":case"/":return t/n;case"=":case"==":return t==n;case"≤":case"<=":return t<=n;case"≥":case">=":return t>=n;case"≠":case"!=":return t!=n;case"∧":case"&&":return t&&n;case"∨":case"||":return t||n;case"<<":return t<<n;case">>":return t>>n}}function kt(e,t){var n=e.match(/([\d.\-]+)(.*)/)||[],r=P(n,3),i=(r[0],r[1]),o=t[r[2]];return void 0===o?o:"number"==typeof o?Number(i)*o:i*bt(xt(o),t)}function wt(e){return e[0]==e[2]&&e[1]==e[3]}function St(e,t){return bt(xt(e),Object.assign({},gt,t))}var jt=new(function(){function e(){R(this,e),this.cache={}}return M(e,[{key:"clear",value:function(){this.cache={}}},{key:"set",value:function(e,t){if(K(e))return"";var n=this.getKey(e);return this.cache[n]=t}},{key:"get",value:function(e){var t=this.getKey(e);return this.cache[t]}},{key:"getKey",value:function(e){return le("string"==typeof e?e:JSON.stringify(e))}}]),e}());function At(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=e+r.join("-");return jt.get(o)||jt.set(o,t.apply(void 0,r))}}function Et(e,t){return{type:e,value:t}}var zt=At("build_range",(function(e){return be(function(e){var t=String(e),n=[],r=[];if(!t.startsWith("[")||!t.endsWith("]"))return n;for(var i=1;i<t.length-1;++i){var o=t[i];if("-"!=o||"-"!=t[i-1])if("-"!=o)if("-"!=ge(r))r.length&&n.push(Et("char",r.pop())),r.push(o);else{r.pop();var a=r.pop();n.push(a?Et("range",[a,o]):Et("char",o))}else r.push(o)}return r.length&&n.push(Et("char",r.pop())),n}(e),(function(e){var t=e.type,n=e.value;if("char"==t)return n;var r=P(n,2),i=r[0],o=r[1],a=!1;if(i>o){var u=[o,i];i=u[0],o=u[1],a=!0}var s=mt(Z)(i,o);return a&&s.reverse(),s}))}));function Tt(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,T(be(n,(function(e){return String(e).startsWith("[")?zt(e):e}))))}}var Pt=function e(t){R(this,e),this.prev=this.next=null,this.data=t},Rt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;R(this,e),this._limit=t,this._size=0}return M(e,[{key:"push",value:function(e){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);var t=new Pt(e);this.root?(t.prev=this.tail,this.tail.next=t,this.tail=t):this.root=this.tail=t,this._size++}},{key:"last",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.tail;--e&&t.prev;)t=t.prev;return t.data}}]),e}(),Mt=function(){function e(t){var n;R(this,e),this.p=(n=t([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]),[].concat(n,n))}return M(e,[{key:"grad",value:function(e,t,n,r){var i=15&e,o=i<8?t:n,a=i<4?n:12==i||14==i?t:r;return(0==(1&i)?o:-o)+(0==(2&i)?a:-a)}},{key:"noise",value:function(e,t,n){var r=this.p,i=this.grad,o=[e,t,n].map((function(e){return 255&Math.floor(e)})),a=P(o,3),u=a[0],s=a[1],c=a[2],l=[e,t,n].map((function(e){return e-Math.floor(e)})),f=P(l,3),v=[e=f[0],t=f[1],n=f[2]].map((function(e){return e*e*e*(e*(6*e-15)+10)})),h=P(v,3),p=h[0],d=h[1],m=h[2],g=r[u]+s,y=r[g]+c,b=r[g+1]+c,x=r[u+1]+s,_=r[x]+c,k=r[x+1]+c;return he(m,he(d,he(p,i(r[y],e,t,n),i(r[_],e-1,t,n)),he(p,i(r[b],e,t-1,n),i(r[k],e-1,t-1,n))),he(d,he(p,i(r[y+1],e,t,n-1),i(r[_+1],e-1,t,n-1)),he(p,i(r[b+1],e,t-1,n-1),i(r[k+1],e-1,t-1,n-1))))}}]),e}();function Nt(e){for(var t,n=S(B(e)),r={},i=[],o=!1;n.next();){var a=n.get(),u=a.prev,s=a.curr,c=a.next;if(s.isSymbol(":")&&!t)t=Ot(i),i=[];else if(s.isSymbol(";")&&t)r[t]=Ct(t,Ot(i),o),i=[],t=null,o=!1;else if(!s.isSymbol(";")){var l=u&&u.isSymbol("-"),f=c&&c.isSymbol("-"),v=s.isSymbol("-");t||i.length||!v||l||f||c&&c.isSymbol(":")?i.push(s):o=!0}}return i.length&&t&&(r[t]=Ct(t,Ot(i),o)),r}function Ct(e,t,n){return["fill-rule","fill"].includes(e)?t:n?"-1 * (".concat(t,")"):t}function Ot(e){return e.map((function(e){return e.value})).join("")}function It(e,t){var n=[],r=[],i=[],o=[];if(ee(e))return n;for(var a,u=S(B(e));u.next();){var s=u.get(),c=(s.prev,s.curr);s.next,c.isSymbol("(")&&i.push(c.value),c.isSymbol(")")&&i.pop(),"open"===c.status&&o.push(c.value),"close"===c.status&&o.pop(),a=c,!(t?a.isSymbol(","):a.isSymbol(",")||a.isSpace())||i.length||o.length?r.push(c):(n.push(Lt(r)),r=[])}return r.length&&n.push(Lt(r)),n}function Lt(e){return e.map((function(e){return e.value})).join("")}var Wt=["auto","reverse"],Ut=["deg","rad","grad","turn"];function Xt(e){for(var t=S(B(e)),n=!1,r="",i={direction:"",angle:""};t.next();){var o=t.get(),a=o.prev,u=o.curr;if(o.next,u.isWord()&&Wt.includes(u.value))i.direction=u.value,n=!0;else if(u.isNumber())i.angle=Number(u.value),n=!0;else if(u.isWord()&&a&&a.isNumber()&&Ut.includes(u.value))r=u.value;else if(u.isSpace()&&""!==i.direction&&""!==i.angle)break}return n||(i.direction="auto"),function(e,t){var n=e.angle;return""===n&&(n=0),"rad"===t&&(n/=Math.PI/180),"grad"===t&&(n*=.9),"turn"===t&&(n*=360),Object.assign({},e,{angle:n})}(i,r)}var $t=Math.cos,Dt=Math.sin,Bt=Math.abs,Ht=Math.atan2,Ft=Math.PI,qt=fe((function(e){return Jt(Nt(e),{min:3,max:3600})})),Yt={circle:function(){return qt(r||(r=z(["\n    split: 180;\n    scale: .99\n  "])))},triangle:function(){return qt(i||(i=z(["\n    rotate: 30;\n    scale: 1.1;\n    move: 0 .2\n  "])))},pentagon:function(){return qt(o||(o=z(["\n    split: 5;\n    rotate: 54\n  "])))},hexagon:function(){return qt(a||(a=z(["\n    split: 6;\n    rotate: 30;\n    scale: .98\n  "])))},octagon:function(){return qt(u||(u=z(["\n    split: 8;\n    rotat: 22.5;\n    scale: .99\n  "])))},star:function(){return qt(s||(s=z(["\n    split: 10;\n    r: cos(5t);\n    rotate: -18;\n    scale: .99\n  "])))},infinity:function(){return qt(c||(c=z(["\n    split: 180;\n    scale: .99;\n    x: cos(t)*.99 / (sin(t)^2 + 1);\n    y: x * sin(t)\n  "])))},heart:function(){return qt(l||(l=z(["\n    split: 180;\n    rotate: 180;\n    a: cos(t)*13/18 - cos(2t)*5/18;\n    b: cos(3t)/18 + cos(4t)/18;\n    x: (.75 * sin(t)^3) * 1.2;\n    y: (a - b + .2) * -1.1\n  "])))},bean:function(){return qt(f||(f=z(["\n    split: 180;\n    r: sin(t)^3 + cos(t)^3;\n    move: -.35 .35;\n  "])))},bicorn:function(){return qt(v||(v=z(["\n    split: 180;\n    x: cos(t);\n    y: sin(t)^2 / (2 + sin(t)) - .5\n  "])))},drop:function(){return qt(h||(h=z(["\n    split: 180;\n    rotate: 90;\n    scale: .95;\n    x: sin(t);\n    y: (1 + sin(t)) * cos(t) / 1.6\n  "])))},fish:function(){return qt(p||(p=z(["\n    split: 240;\n    x: cos(t) - sin(t)^2 / sqrt(2) - .04;\n    y: sin(2t)/2\n  "])))},whale:function(){return qt(d||(d=z(["\n    split: 240;\n    rotate: 180;\n    R: 3.4 * (sin(t)^2 - .5) * cos(t);\n    x: cos(t) * R + .75;\n    y: sin(t) * R * 1.2\n  "])))},windmill:function(){return qt(m||(m=z(["\n    split: 18;\n    R: seq(.618, 1, 0);\n    T: seq(t-.55, t, t);\n    x: R * cos(T);\n    y: R * sin(T)\n  "])))},vase:function(){return qt(g||(g=z(["\n    split: 240;\n    scale: .3;\n    x: sin(4t) + sin(t) * 1.4;\n    y: cos(t) + cos(t) * 4.8 + .3\n  "])))},clover:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return 4==(e=Y(e,3,5))&&(e=2),qt(y||(y=z(["\n      split: 240;\n      r: cos(","t);\n      scale: .98\n    "])),e)},hypocycloid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=[0,0,0,.34,.25,.19][e=Y(e,3,5)];return qt(b||(b=z(["\n      split: 240;\n      scale: ",";\n      k: ",";\n      x: (k-1)*cos(t) + cos((k-1)*t);\n      y: (k-1)*sin(t) - sin((k-1)*t)\n    "])),t,e)},bud:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return e=Y(e,3,10),qt(x||(x=z(["\n      split: 240;\n      scale: .8;\n      r: 1 + .2 * cos(","t)\n    "])),e)}},Vt=function(){function e(t,n,r){R(this,e),this.x=t,this.y=n,this.extra=r}return M(e,[{key:"valueOf",value:function(){return this.x+" "+this.y}},{key:"toString",value:function(){return this.valueOf()}}]),e}();function Zt(e,t,n,r,i){var o=180*Ht(t+r,e-n)/Ft;return"reverse"===i.direction&&(o-=180),i.direction||(o=90),i.angle&&(o+=i.angle),o}function Gt(e,t,n){var r=It(n).map(Number),i=P(r,2),o=i[0],a=i[1];return[e*o,t*(void 0===a?o:a)]}function Jt(e,t){var n=t.min,r=t.max,i=Y(parseInt(e.vertices||e.points||e.split)||0,n,r),o=ee(e.x)?"cos(t)":e.x,a=ee(e.y)?"sin(t)":e.y,u=ee(e.r)?"":e.r,s=pt(u),c=s.unit,l=s.value;return c&&!e[c]&&"t"!==c&&(ee(e.unit)&&(e.unit=c),u=e.r=l),e.degree&&(e.rotate=e.degree),e.origin&&(e.move=e.origin),function(e,t){"function"==typeof arguments[0]&&(t=e,e={}),t||(t=function(e){return[$t(e),Dt(e)]});var n,r,i=e.split||180,o=e.turn||1,a=e.frame,u=e.fill||e["fill-rule"],s=Xt(e.direction||e.dir||""),c=e.unit,l=2*Ft*o/i,f=[],v=void 0===e.scale?1:e.scale,h=function(e){var t=P(e,4),n=t[0],r=t[1],i=t[2],o=void 0===i?0:i,a=t[3],u=void 0===a?0:a;if("evenodd"==n||"nonzero"==n)return f.push(new Vt(n,"",""));var l=Gt(n,-r,v),h=P(l,2),p=h[0],d=h[1],m=Gt(o,-u,v),g=P(m,2),y=Zt(p,d,g[0],g[1],s);void 0!==c&&"%"!==c?"none"!==c&&(p+=c,d+=c):(p=50*(p+1)+"%",d=50*(d+1)+"%"),f.push(new Vt(p,d,y))};"nonzero"!=u&&"evenodd"!=u||h([u,"",""]);for(var p=0;p<i;++p){var d=l*p,m=t(d,p);p||(n=m),h(m)}if(void 0!==a){h(n);var g=a/100;o>1&&(g*=2),0==g&&(g=.002);for(var y=0;y<i;++y){var b=-l*y,x=t(b,y),_=P(x,4),k=_[0],w=_[1],S=_[2],j=void 0===S?0:S,A=_[3],E=void 0===A?0:A,z=Ht(w+E,k-j),T=[k-g*$t(z),w-g*Dt(z)];y||(r=T),h(T)}h(r),h(n)}return f}(Object.assign({},e,{split:i}),(function(t,n){var r=Object.assign({},e,{t:t,"θ":t,i:n+1,seq:function(){var e;return arguments.length?(e=n%arguments.length)<0||arguments.length<=e?void 0:arguments[e]:""},range:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((e=Number(e)||0)>(t=Number(t)||0)){var r=[t,e];e=r[0],t=r[1]}var o=Bt(t-e)/(i-1);return e+o*n}}),s=St(o,r),c=St(a,r),l=0,f=0;if(u){var v=St(u,r);0==v&&(v=1e-5),s=v*$t(t),c=v*Dt(t)}if(e.rotate){var h=function(e,t,n){var r=-Ft/180*n;return[e*$t(r)-t*Dt(r),t*$t(r)+e*Dt(r)]}(s,c,Number(e.rotate)||0),p=P(h,2);s=p[0],c=p[1]}if(e.move){var d=function(e,t,n){var r=It(n).map(Number),i=P(r,2),o=i[0],a=i[1],u=void 0===a?o:a;return[e+(o||0),t-(u||0),o,u]}(s,c,e.move),m=P(d,4);s=m[0],c=m[1],l=m[2],f=m[3]}return[s,c,l,f]}))}function Kt(e,t){for(var n,r=[],i=[];e.next();){var o=e.get(),a=o.curr,u=o.next,s=!i.length&&(!u||a.isSymbol(";")||u.isSymbol("}"));if(a.isSymbol("'",'"')&&("open"===a.status?i.push(a):i.pop()),!i.length&&a.isSymbol("{")){var c=rn(r,(function(e){return e.isSpace()}));if(!c.length)continue;var l=c.pop(),f=on.apply(void 0,T(c).concat([l]));for(n=nn(Qt(e,{type:"block",name:l,inline:!0,value:[]}),f);l=c.pop();)n=nn({type:"block",name:l,value:[n]},f);break}if("open"==a.status&&1==i.length||"close"==a.status&&!i.length||r.push(a),s)break}return r.length&&!n?t.value=tn(r):n&&(t.value=n),t}function Qt(e,t){for(var n=[],r=[],i=t&&t.type||"",o=[];e.next();){var a=e.get(),u=a.prev,s=a.curr,c=a.next,l=!c||s.isSymbol("}");if(s.isSymbol("(")&&o.push(s.value),s.isSymbol(")")&&o.pop(),an(i)&&l){c||!n.length||s.isSymbol("}")||"string"==typeof n[n.length-1].value&&(n[n.length-1].value+=";"+s.value),t.value=n;break}if(s.isSymbol("{")){var f=rn(r,(function(e){return e.isSpace()}));if(!f.length)continue;on(t.name)&&(f=[tn(r)]);for(var v=f.pop(),h=on.apply(void 0,T(f).concat([t.name,v])),p=nn(Qt(e,{type:"block",name:v,value:[]}),h);v=f.pop();)p=nn({type:"block",name:v,value:[p]},h);n.push(p),r=[]}else s.isSymbol(":")&&!o.length&&!en(u,c)&&r.length?function(){var o=rn(r,(function(e){return e.isSymbol(",")})),a=Kt(e,{type:"statement",name:"unkown",value:""}),u=It(a.value),s=o.length>1&&u.length===o.length;o.forEach((function(e,t){var r=Object.assign({},a,{name:e});s&&(r.value=u[t]),n.push(r)})),an(i)&&(t.value=n),r=[]}():s.isSymbol(";")?n.length&&r.length&&(n[n.length-1].value+=";"+tn(r),r=[]):r.push(s)}return n.length&&an(i)&&(t.value=n),i?t:n}function en(e,t){var n=e&&e.value,r=t&&t.value;return["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"].includes(n+":"+r)}function tn(e){return e.filter((function(t,n){return!t.isSymbol(";","}")||n!==e.length-1})).map((function(e){return e.value})).join("")}function nn(e,t){var n=(e.name||"").split(/#/),r=E(n),i=r[0],o=r.slice(1),a=o[o.length-1];return i&&a&&!t&&(e.name=i,e.value.push({type:"statement",name:"id",value:a})),e}function rn(e,t){var n=[],r=[];return e.forEach((function(e){t(e)?(n.push(tn(r)),r=[]):r.push(e)})),r.length&&n.push(tn(r)),n}function on(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((function(e){return"style"===e}))}function an(e){return"block"===e}function un(e,t){return function e(t){var n=t&&t.value&&t.value[0];return n&&"svg"===n.name&&an(n.type)?e(n):t}(Qt(S(B(e)),t||{type:"block",name:"svg",value:[]}))}function sn(e){for(var t=S(B(e)),n={},r={commands:[],valid:!0};t.next();){var i=t.get().curr;if(!i.isSpace()&&!i.isSymbol(","))if(i.isWord())n.name&&(r.commands.push(n),n={}),n.name=i.value,n.value=[],"MmLlHhVvCcSsQqTtAaZz".includes(i.value)?"mlhvcsqtaz".includes(i.value)?n.type="relative":n.type="absolute":(n.type="unknown",r.valid=!1);else if(n.value){var o=i.value;i.isNumber()&&(o=Number(i.value)),n.value.push(o)}else n.name||(r.valid=!1)}return n.name&&r.commands.push(n),r}var cn={name:"cssd-uniform-time","animation-name":"cssd-uniform-time-animation","animation-duration":31536e6,"animation-iteration-count":"infinite","animation-delay":"0s","animation-direction":"normal","animation-fill-mode":"none","animation-play-state":"running","animation-timing-function":"linear"};cn.animation="\n  ".concat(cn["animation-duration"],"ms\n  ").concat(cn["animation-timing-function"],"\n  ").concat(cn["animation-delay"],"\n  ").concat(cn["animation-iteration-count"],"\n  ").concat(cn["animation-name"],"\n");var ln={name:"cssd-uniform-mousex"},fn={name:"cssd-uniform-mousey"},vn={name:"cssd-uniform-width"},hn={name:"cssd-uniform-height"},pn=Object.freeze({__proto__:null,uniform_time:cn,uniform_mousex:ln,uniform_mousey:fn,uniform_width:vn,uniform_height:hn});function dn(e){return te((function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(!r||!t)return"";var o=ie(t()),a=St(o);return 0===a&&(a=o),ne(a,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.map((function(e){return ie(e.apply(void 0,t))})).join(",")})).join(e)}))}function mn(e,t,n){return e[t]||(e[t]=new Rt),e[t].push(n),n}function gn(e){return-1*e}function yn(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=2,o=Math.sqrt(i/4)*r,a=-o,u=o;return he((e-a)/(u-a),t*r,n*r)}var bn=G({i:function(e){var t=e.count;return function(e){return t}},y:function(e){var t=e.y;return function(e){return t}},x:function(e){var t=e.x;return function(e){return t}},z:function(e){var t=e.z;return function(e){return t}},I:function(e){var t=e.grid;return function(e){return t.count}},Y:function(e){var t=e.grid;return function(e){return t.y}},X:function(e){var t=e.grid;return function(e){return t.x}},Z:function(e){var t=e.grid;return function(e){return t.z}},id:function(e){var t=e.x,n=e.y,r=e.z;return function(e){return re(t,n,r)}},n:function(e){var t=ge(e.extra);return function(e){return t?t[0]+(Number(e)||0):"@n"}},nx:function(e){var t=ge(e.extra);return function(e){return t?t[1]+(Number(e)||0):"@nx"}},ny:function(e){var t=ge(e.extra);return function(e){return t?t[2]+(Number(e)||0):"@ny"}},N:function(e){var t=ge(e.extra);return function(e){return t?t[3]+(Number(e)||0):"@N"}},m:dn(","),M:dn(" "),"µ":dn(""),p:function(e){var t=e.context,n=e.pick;return Tt((function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];r.length||(r=t.last_pick_args||[]);var o=n(r);return t.last_pick_args=r,mn(t,"last_pick",o)}))},P:function(e){var t=e.context,n=e.pick,r="P-counter"+e.position;return Tt((function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];var a=!0;i.length||(i=t.last_pick_args||[],a=!1);var u=t.last_pick,s=u?u.last(1):"";if(a&&(t[r]||(t[r]={}),s=t[r].last_pick),i.length>1){var c=i.findIndex((function(e){return e===s}));-1!==c&&i.splice(c,1)}var l=n(i);return t.last_pick_args=i,a&&(t[r].last_pick=l),mn(t,"last_pick",l)}))},pn:function(e){var t=e.context,n=e.extra,r="pn-counter"+e.position,i=ge(n);return Tt((function(){t[r]||(t[r]=0),t[r]+=1;var e=arguments.length,n=i||[],o=P(n,1),a=o[0],u=void 0===a?t[r]:a,s=(u-1)%e,c=s<0||arguments.length<=s?void 0:arguments[s];return mn(t,"last_pick",c)}))},pd:function(e){var t=e.context,n=e.extra,r=e.position,i=e.shuffle,o="pd-counter"+r,a="pd-values"+r,u=ge(n);return Tt((function(){t[o]||(t[o]=0),t[o]+=1;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t[a]||(t[a]=i(n||[]));var s=n.length,c=u||[],l=P(c,1),f=l[0],v=void 0===f?t[o]:f,h=(v-1)%s,p=t[a][h];return mn(t,"last_pick",p)}))},lp:function(e){var t=e.context;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=t.last_pick;return n?n.last(e):""}},r:function(e){var t=e.context,n=e.rand;return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o=r.every(J)?mt:dt,a=o(n).apply(void 0,r);return mn(t,"last_rand",a)}},rn:function(e){var t=e.x,n=e.y,r=e.context,i=e.position,o=e.grid,a=e.extra,u=e.shuffle,s="noise-2d"+i,c=ge(a)||[],l=P(c,6),f=l[0],v=l[1],h=l[2],p=l[3],d=l[4],m=l[5],g=f&&p;return function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];var c=i[0],l=i[1],f=void 0===l?c:l,p=i[2],y=void 0===p?1:p,b=i[3],x=void 0===b?1:b;if(1==i.length){var _=[0,c];c=_[0],f=_[1]}r[s]||(r[s]=new Mt(u)),y=Y(y,0,1/0),x=Y(x,0,1/0);var k=[c,f].every(J)?mt:dt,w=g?r[s].noise((v-1)/d*y,(h-1)/m*y,0):r[s].noise((t-1)/o.x*y,(n-1)/o.y*y,0),S=k((function(e,t){return yn(w*x,e,t,x)})),j=S(c,f);return mn(r,"last_rand",j)}},lr:function(e){var t=e.context;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=t.last_rand;return n?n.last(e):""}},noise:function(e){var t=e.context,n=e.grid,r=e.position,i=e.shuffle,o=A(e,N),a={i:o.count,I:n.count,x:o.x,X:n.x,y:o.y,Y:n.y,z:o.z,Z:n.z};return function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u="raw-noise-2d"+r;return t[u]||(t[u]=new Mt(i)),t[u].noise(St(e,a),St(n,a),St(o,a))}},stripe:function(){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=t.map(ie),o=i.length,a=0,u=[];if(!o)return"";i.forEach((function(e){var t=It(e),n=P(t,2),r=(n[0],n[1]);void 0!==r?u.push(r):a+=1}));var s=u.length?"(100% - ".concat(u.join(" - "),") / ").concat(a):"100% / ".concat(o);return i.map((function(e,t){if(u.length){var n=It(e),i=P(n,2),a=i[0],c=i[1];return r=(r?r+" + ":"")+(void 0!==c?c:s),"".concat(a," 0 calc(").concat(r,")")}return"".concat(e," 0 ").concat(100/o*(t+1),"%")})).join(",")}},calc:function(){return function(e){return St(ie(e))}},hex:function(){return function(e){return parseInt(ie(e)).toString(16)}},svg:te((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e){return ie(e())})).join(",");if(!r.startsWith("<")){var i=un(r);r=ht(i)}var o=st(r);return ut(o)})),filter:te((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e){return ie(e())})).join(","),i=pe("filter-");if(!r.startsWith("<")){var o=un(r,{type:"block",name:"filter"});r=ht(o)}var a=st(r).replace(/<filter([\s>])/,'<filter id="'.concat(i,'"$1'));return ut(a,i)})),var:function(){return function(e){return"var(".concat(ie(e),")")}},ut:function(){return function(e){return"var(--".concat(cn.name,")")}},uw:function(){return function(e){return"var(--".concat(vn.name,")")}},uh:function(){return function(e){return"var(--".concat(hn.name,")")}},ux:function(){return function(e){return"var(--".concat(ln.name,")")}},uy:function(){return function(e){return"var(--".concat(fn.name,")")}},plot:function(e){var t=e.count,n=e.context,r=e.extra,i=e.position,o=e.grid,a="offset-points"+i,u=ge(r);return function(e){var r=P(u||[],4),i=r[0],s=void 0===i?t:i,c=(r[1],r[2],r[3]),l=void 0===c?o.count:c;if(!n[a]){var f=Nt(e);delete f.fill,delete f["fill-rule"],delete f.frame,f.points=l,n[a]=Jt(f,{min:1,max:65536})}return n[a][s-1]}},shape:function(){return At("shape-function",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];if((e=String(e).trim()).length){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if("function"==typeof Yt[e])t=Yt[e](r);else{var o=e,a=r.join(",");a.length&&(o=e+","+a);var u=Nt(o);t=Jt(u,{min:3,max:3600})}}return"polygon(".concat(t.join(","),")")}))},doodle:function(){return function(e){return e}},shaders:function(){return function(e){return e}},canvas:function(){return function(e){return e}},pattern:function(){return function(e){return e}},invert:function(){return function(e){var t=sn(e);return t.valid?t.commands.map((function(e){var t=e.name,n=e.value;switch(t){case"v":return"h"+n.join(" ");case"V":return"H"+n.join(" ");case"h":return"v"+n.join(" ");case"H":return"V"+n.join(" ");default:return t+n.join(" ")}})).join(" "):e}},flipH:function(){return function(e){var t=sn(e);return t.valid?t.commands.map((function(e){var t=e.name,n=e.value;switch(t){case"h":case"H":return t+n.map(gn).join(" ");default:return t+n.join(" ")}})).join(" "):e}},flipV:function(){return function(e){var t=sn(e);return t.valid?t.commands.map((function(e){var t=e.name,n=e.value;switch(t){case"v":case"V":return t+n.map(gn).join(" ");default:return t+n.join(" ")}})).join(" "):e}},flip:function(){var e=bn.flipH.apply(bn,arguments),t=bn.flipV.apply(bn,arguments);return function(n){return t(e(n))}},reverse:function(){return function(e){var t=sn(e);return t.valid?t.commands.reverse().map((function(e){return e.name+e.value.join(" ")})).join(" "):e}}},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",t:"ut","svg-filter":"filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"µ",repeat:"µ",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z","pick-by-turn":"pn","pick-n":"pn","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",paint:"canvas"}),xn={"4a0":[1682,2378],"2a0":[1189,1682],a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],a7:[74,105],a8:[52,74],a9:[37,52],a10:[26,37],b0:[1e3,1414],b1:[707,1e3],b2:[500,707],b3:[353,500],b4:[250,353],b5:[176,250],b6:[125,176],b7:[88,125],b8:[62,88],b9:[44,62],b10:[31,44],b11:[22,32],b12:[16,22],c0:[917,1297],c1:[648,917],c2:[458,648],c3:[324,458],c4:[229,324],c5:[162,229],c6:[114,162],c7:[81,114],c8:[57,81],c9:[40,57],c10:[28,40],c11:[22,32],c12:[16,22],d0:[764,1064],d1:[532,760],d2:[380,528],d3:[264,376],d4:[188,260],d5:[130,184],d6:[92,126],letter:[216,279],postcard:[100,148],poster:[390,540]},_n={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"},kn=[];function wn(e){if(!kn.length){var t=new Set;if("undefined"!=typeof document)for(var n in document.head.style)n.startsWith("-")||t.add(n.replace(/[A-Z]/g,"-$&").toLowerCase());t.has("grid-gap")||t.add("grid-gap"),kn=Array.from(t)}return e instanceof RegExp?kn.filter((function(t){return e.test(t)})):kn}function Sn(e){var t=new RegExp("\\-?".concat(e,"\\-?"));return wn(t).map((function(e){return e.replace(t,"")})).reduce((function(e,t){return e[t]=t,e}),{})}var jn=Sn("webkit"),An=Sn("moz");function En(e,t){return jn[e]?"-webkit-".concat(t," ").concat(t):An[e]?"-moz-".concat(t," ").concat(t):t}var zn={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},Tn={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"},Pn=G({size:function(e,t){var n=t.is_special_selector,r=t.grid,i=It(e),o=P(i,2),a=o[0],u=o[1],s=void 0===u?a:u;if(xn[a]){var c=function(e,t){e=String(e).toLowerCase();var n=P(xn[e]||[],2),r=n[0],i=n[1];if("p"==_n[t]){var o=[r,i];i=o[0],r=o[1]}return[i,r].map((function(e){return e+"mm"}))}(a,s),l=P(c,2);a=l[0],s=l[1]}var f="\n      width: ".concat(a,";\n      height: ").concat(s,";\n    ");return n?"auto"!==a&&"auto"!==s||(f+="aspect-ratio: ".concat(r.ratio,";")):f+="\n        --internal-cell-width: ".concat(a,";\n        --internal-cell-height: ").concat(s,";\n      "),f},offset:function(e,t){var n=t.extra,r=It(e),i=P(r,2),o=i[0],a=i[1],u=void 0===a?"50%":a;u=Tn[u]||u;var s="var(--internal-cell-width, 25%)",c="var(--internal-cell-height, 25%)";return"\n      position: absolute;\n      left: ".concat(o=zn[o]||o,";\n      top: ").concat(u,";\n      width: ").concat(s,";\n      height: ").concat(c,";\n      margin-left: calc(").concat(s," / -2);\n      margin-top: calc(").concat(c," / -2);\n      grid-area: unset;\n      --plot-angle: ").concat(n||0,";\n      transform: rotate(").concat(n||0,"deg);\n    ")},grid:function(e,t){var n=e.split("/").map((function(e){return e.trim()})),r=E(n),i=r[0],o=r.slice(1);return o=o.join(" / "),{grid:nt(i),size:o?this.size(o,t):""}},shape:At("shape-property",(function(e){var t=It(e),n=E(t),r=n[0],i=n.slice(1);if("function"!=typeof Yt[r])return"";var o=Yt[r].apply(Yt,T(i));return En("clip-path","".concat("clip-path",": polygon(").concat(o.join(","),");"))+"overflow: hidden;"})),use:function(e){if(e.length>2)return e}},{"place-cell":"offset"}),Rn={even:function(e){return!(e%2)},odd:function(e){return!!(e%2)}};function Mn(e,t,n){for(var r=0;r<=n;++r)if(St(e,{n:r})==t)return!0}var Nn={at:function(e){var t=e.x,n=e.y;return function(e,r){return t==e&&n==r}},nth:function(e){var t=e.count,n=e.grid;return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return r.some((function(e){return Rn[e]?Rn[e](t):Mn(e,t,n.count)}))}},row:function(e){var t=e.y,n=e.grid;return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return r.some((function(e){return Rn[e]?Rn[e](t):Mn(e,t,n.y)}))}},col:function(e){var t=e.x,n=e.grid;return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return r.some((function(e){return Rn[e]?Rn[e](t):Mn(e,t,n.x)}))}},even:function(e){e.count,e.grid;var t=e.x,n=e.y;return function(e){return Rn.odd(t+n)}},odd:function(e){e.count,e.grid;var t=e.x,n=e.y;return function(e){return Rn.even(t+n)}},random:function(e){var t=e.random;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return e>=1&&e<=0&&(e=.5),t()<e}},match:function(e){var t=e.count,n=e.grid,r=e.x,i=e.y,o=e.random;return function(e){return!!St("("+e+")",{x:r,X:n.x,y:i,Y:n.y,i:t,I:n.count,random:o})}}};function Cn(e){return/^\:(host|doodle)/.test(e)}function On(e){return/^\:(container|parent)/.test(e)}function In(e){return Cn(e)||On(e)}var Ln,Wn={},Un=O(Object.getOwnPropertyNames(Math));try{var Xn=function(){var e=Ln.value;Wn[e]=function(){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"number"==typeof Math[e]?Math[e]:(n=n.map((function(e){return St(ie(e))})),Math[e].apply(Math,T(n)))}}};for(Un.s();!(Ln=Un.n()).done;)Xn()}catch(_r){Un.e(_r)}finally{Un.f()}var $n=function(){function e(t){R(this,e),this.tokens=t,this.rules={},this.props={},this.keyframes={},this.grid=null,this.is_grid_defined=!1,this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={},this.reset(),this.custom_properties={},this.uniforms={}}return M(e,[{key:"reset",value:function(){for(var e in this.styles={host:"",container:"",cells:"",keyframes:""},this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={},this.rules)e.startsWith("#c")&&delete this.rules[e]}},{key:"add_rule",value:function(e,t){var n=this.rules[e];n||(n=this.rules[e]=[]),n.push.apply(n,de(t))}},{key:"pick_func",value:function(e){return bn[e]||Wn[e]}},{key:"apply_func",value:function(e,t,n){var r=e.apply(void 0,T(de(t))),i=[];return n.forEach((function(e){var t,n=typeof e.value,r="number"===n||"string"===n;if(!e.cluster&&r)(t=i).push.apply(t,T(It(e.value,!0)));else if("function"==typeof e)i.push(e);else if(!K(e.value)){var o=ie(e.value);i.push(o)}})),i=i.filter((function(e){return!K(e)&&String(e).trim().length})),r.apply(void 0,T(de(i)))}},{key:"compose_aname",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("-")}},{key:"compose_selector",value:function(e){var t=e.x,n=e.y,r=e.z,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"#".concat(re(t,n,r)).concat(i)}},{key:"is_composable",value:function(e){return["doodle","shaders","canvas","pattern"].includes(e)}},{key:"read_var",value:function(e,t){var n=t.count,r=this.custom_properties[n]||{};if(void 0!==r[e]){var i=String(r[e]).trim();return"("==i[0]&&")"===i[i.length-1]&&(i=i.substring(1,i.length-1)),i.replace(/;+$/g,"")}return e}},{key:"compose_argument",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0;t.extra||(t.extra=[]),t.extra.push(r);var o=e.map((function(e){if("text"===e.type)return/^\-\-\w/.test(e.value)?i&&"@var"===i.name?e.value:n.read_var(e.value,t):e.value;if("func"===e.type){var o=e.name.substr(1),a=n.pick_func(o);if("function"==typeof a){if(n.check_uniforms(o),n.is_composable(o)){var u=ie((e.arguments[0]||[])[0]);if(!K(u))switch(o){case"doodle":return n.compose_doodle(n.inject_variables(u,t.count));case"shaders":return n.compose_shaders(u,t);case"canvas":return n.compose_canvas(u,e.arguments.slice(1));case"pattern":return n.compose_pattern(u,t)}}t.position=e.position;var s=Object.assign({},t,{extra:T(t.extra)}),c=e.arguments.map((function(i){return a.lazy?function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.compose_argument(i,s,r,e)}:n.compose_argument(i,t,r,e)}));return n.apply_func(a,t,c)}return e.name}}));return t.extra.pop(),{cluster:e.cluster,value:o.length>=2?{value:o.join("")}:o[0]}}},{key:"compose_doodle",value:function(e){var t=pe("doodle");return this.doodles[t]=e,"${"+t+"}"}},{key:"compose_shaders",value:function(e,t){var n=t.x,r=t.y,i=t.z,o=pe("shader");return this.shaders[o]={shader:e,cell:re(n,r,i)},"${"+o+"}"}},{key:"compose_pattern",value:function(e,t){var n=t.x,r=t.y,i=t.z,o=pe("pattern");return this.pattern[o]={code:e,cell:re(n,r,i)},"${"+o+"}"}},{key:"compose_canvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e,r=t.map((function(e){return ie(e[0])})).join(",");r.length&&(n=e+","+r);var i=pe("canvas");return this.canvas[i]={code:n},"${"+i+"}"}},{key:"check_uniforms",value:function(e){switch(e){case"ut":case"t":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0}}},{key:"inject_variables",value:function(e,t){var n=this.custom_properties[t];if(K(n))return e;for(var r=[],i=0,o=Object.entries(n);i<o.length;i++){var a=P(o[i],2),u=a[0],s=a[1];r.push("".concat(u,": ").concat(s,";"))}return r.join("")+e}},{key:"compose_value",value:function(e,t){var n=this;if(!Array.isArray(e))return{value:"",extra:""};var r="";return{value:e.reduce((function(e,i){switch(i.type){case"text":e+=i.value;break;case"func":var o=i.name.substr(1),a=n.pick_func(o);if("function"==typeof a)if(n.check_uniforms(o),n.is_composable(o)){var u=ie((i.arguments[0]||[])[0]);if(!K(u))switch(o){case"doodle":e+=n.compose_doodle(n.inject_variables(u,t.count));break;case"shaders":e+=n.compose_shaders(u,t);break;case"pattern":e+=n.compose_pattern(u,t);break;case"canvas":e+=n.compose_canvas(u,i.arguments.slice(1))}}else{t.position=i.position;var s=i.arguments.map((function(e){return a.lazy?function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n.compose_argument(e,t,o,i)}:n.compose_argument(e,t,[],i)})),c=n.apply_func(a,t,s);K(c)||(e+=c),c.extra&&(r=c.extra)}}return e}),""),extra:r}}},{key:"compose_rule",value:function(e,t,n){var r,i=this,o=Object.assign({},t),a=e.property,u=e.value.reduce((function(e,t){var n=i.compose_value(t,o);return n&&(n.value&&e.push(n.value),n.extra&&(r=n.extra)),e}),[]),s=u.join(", ");if(/^animation(\-name)?$/.test(a)){if(this.props.has_animation=!0,Cn(n)){var c=cn[a];c&&s&&(s=c+","+s)}if(o.count>1){var l=o.count;switch(a){case"animation-name":s=u.map((function(e){return i.compose_aname(e,l)})).join(", ");break;case"animation":s=u.map((function(e){var t=(e||"").split(/\s+/);return t[0]=i.compose_aname(t[0],l),t.join(" ")})).join(", ")}}}"content"===a&&(/["']|^none$|^(var|counter|counters|attr|url)\(/.test(s)||(s="'".concat(s,"'"))),"transition"===a&&(this.props.has_transition=!0);var f="".concat(a,": ").concat(s,";");if(f=En(a,f),"clip-path"===a&&(f+=";overflow: hidden;"),"width"!==a&&"height"!==a||In(n)||(f+="--internal-cell-".concat(a,": ").concat(s,";")),"background"===a&&(s.includes("shader")||s.includes("canvas")||s.includes("pattern"))&&(f+="background-size: 100% 100%;"),/^\-\-/.test(a)&&(this.custom_properties[t.count]||(this.custom_properties[t.count]={}),this.custom_properties[t.count][a]=s),/^@/.test(a)&&Pn[a.substr(1)]){var v=a.substr(1),h=Pn[v](s,{is_special_selector:In(n),grid:o.grid,extra:r});switch(v){case"grid":Cn(n)?f=h.size||"":(f="",this.is_grid_defined||(h=Pn[v](s,{is_special_selector:!0,grid:o.grid}),this.add_rule(":host",h.size||""))),this.grid=o.grid,this.is_grid_defined=!0;break;case"place-cell":case"offset":Cn(n)||(f=h);break;case"use":e.value.length&&this.compose(o,e.value),f="";break;default:f=h}}return f}},{key:"pre_compose_rule",value:function(e,t){var n=this,r=Object.assign({},t),i=e.property;switch(i){case"@grid":var o=e.value.reduce((function(e,t){var i=n.compose_value(t,r);return i&&i.value&&e.push(i.value),e}),[]).join(", "),a=i.substr(1),u=Pn[a](o,{});this.grid=u.grid;break;case"@use":e.value.length&&this.pre_compose(r,e.value)}}},{key:"pre_compose",value:function(e,t){var n=this;(t||this.tokens).forEach((function(t){switch(t.type){case"rule":n.pre_compose_rule(t,e);break;case"pseudo":Cn(t.selector)&&(t.styles||[]).forEach((function(t){n.pre_compose_rule(t,e)}))}}))}},{key:"compose",value:function(e,t,n){var r=this;this.coords.push(e),(t||this.tokens).forEach((function(t,i){if(t.skip)return!1;if(n&&r.grid)return!1;switch(t.type){case"rule":r.add_rule(r.compose_selector(e),r.compose_rule(t,e));break;case"pseudo":t.selector.startsWith(":doodle")&&(t.selector=t.selector.replace(/^\:+doodle/,":host"));var o=In(t.selector);o&&(t.skip=!0),t.selector.split(",").forEach((function(n){var i=t.styles.map((function(t){return r.compose_rule(t,e,n)})),a=o?n:r.compose_selector(e,n);r.add_rule(a,i)}));break;case"cond":var a=Nn[t.name.substr(1)];if(a){var u=t.arguments.map((function(t){return r.compose_argument(t,e)}));r.apply_func(a,e,u)&&r.compose(e,t.styles)}break;case"keyframes":r.keyframes[t.name]||(r.keyframes[t.name]=function(e){return"\n              ".concat(me(t.steps.map((function(t){return"\n                ".concat(t.name," {\n                  ").concat(me(t.styles.map((function(t){return r.compose_rule(t,e)}))),"\n                }\n              ")}))),"\n            ")})}}))}},{key:"output",value:function(){for(var e=this,t=0,n=Object.entries(this.rules);t<n.length;t++){var r=P(n[t],2),i=r[0],o=r[1];if(On(i))this.styles.container+="\n          .container {\n            ".concat(me(o),"\n          }\n        ");else{var a=Cn(i)?"host":"cells",u=me(o).trim(),s="host"===a?"".concat(i,", .host"):i;this.styles[a]+="".concat(s," { ").concat(u," }")}}return this.uniforms.time&&(this.styles.container+="\n        :host, .host {\n          animation: ".concat(cn.animation,";\n        }\n      "),this.styles.keyframes+="\n       @keyframes ".concat(cn["animation-name"]," {\n         from { --").concat(cn.name,": 0 }\n         to { --").concat(cn.name,": ").concat(cn["animation-duration"]/10," }\n       }\n      ")),this.coords.forEach((function(t,n){for(var r=0,i=Object.entries(e.keyframes);r<i.length;r++){var o=P(i[r],2),a=o[0],u=o[1],s=e.compose_aname(a,t.count);e.styles.keyframes+="\n          ".concat(V(0===n,"@keyframes ".concat(a," { ").concat(u(t)," }")),"\n          @keyframes ").concat(s," {\n            ").concat(u(t),"\n          }\n        ")}})),{props:this.props,styles:this.styles,grid:this.grid,doodles:this.doodles,shaders:this.shaders,canvas:this.canvas,pattern:this.pattern,uniforms:this.uniforms}}}]),e}();function Dn(e,t,n){var r=new $n(e),i={};function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;if(1==arguments.length){var r=[0,e];e=r[0],t=r[1]}return he(n(),e,t)}function a(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t.reduce((function(e,t){return e.concat(t)}),[]);return i[~~(n()*i.length)]}function u(e){for(var t=T(e),r=e.length;r;){var i=~~(n()*r--),o=t[r];t[r]=t[i],t[i]=o}return t}r.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:n,rand:o,pick:a,shuffle:u});var s=r.output().grid;if(s&&(t=s),r.reset(),1==t.z)for(var c=1,l=0;c<=t.y;++c)for(var f=1;f<=t.x;++f)r.compose({x:f,y:c,z:1,count:++l,grid:t,context:i,random:n,rand:o,pick:a,shuffle:u});else for(var v=1,h=0;v<=t.z;++v)r.compose({x:1,y:1,z:v,count:++h,grid:t,context:i,random:n,rand:o,pick:a,shuffle:u});return r.output()}function Bn(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function Hn(e,t){return e.includes(t)?e:t+"\n"+e}function Fn(e,t,n){var r=jt.get(e);if(r)return Promise.resolve(r);var i=document.createElement("canvas"),o=window.devicePixelRatio||1;t*=o,n*=o,i.width=t,i.height=n;var a=i.getContext("webgl2");if(!a)return Promise.resolve("");var u=Hn(e.fragment||"","uniform vec2 u_resolution;");e.textures.forEach((function(e){var t="uniform sampler2D ".concat(e.name,";");u=Hn(u,t)}));var s=function(e,t,n){var r=Bn(e,e.VERTEX_SHADER,t),i=Bn(e,e.FRAGMENT_SHADER,n),o=e.createProgram();return e.attachShader(o,r),e.attachShader(o,i),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(console.warn("Link failed: "+e.getProgramInfoLog(o)),console.warn("vs info-log: "+e.getShaderInfoLog(r)),console.warn("fs info-log: "+e.getShaderInfoLog(i))),o}(a,e.vertex||"#version 300 es\n  in vec4 position;\n  void main() {\n    gl_Position = position;\n  }\n","#version 300 es\n  precision highp float;\n  out vec4 FragColor;\n"+u),c=a.getAttribLocation(s,"position"),l=a.createBuffer();return a.bindBuffer(a.ARRAY_BUFFER,l),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1,-1,1,1,-1]),a.STATIC_DRAW),a.enableVertexAttribArray(c),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(s),a.uniform2fv(a.getUniformLocation(s,"u_resolution"),[t,n]),e.textures.forEach((function(e,t){!function(e,t,n){var r=e.createTexture();e.activeTexture(e["TEXTURE"+n]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)}(a,e.value,t),a.uniform1i(a.getUniformLocation(s,e.name),t)})),a.drawArrays(a.TRIANGLES,0,6),Promise.resolve(jt.set(e,i.toDataURL()))}function qn(e,t){for(var n=[];e.next();){var r=e.get(),i=r.curr,o=r.next,a=!o||i.isSymbol(";")||o.isSymbol("}");if(n.push(i),a)break}return n.length&&(t.value=Yn(n)),t}function Yn(e){return e.filter((function(t,n){return!t.isSymbol(";")||n!==e.length-1})).map((function(e){return e.value})).join("")}function Vn(e){for(var t=S(e),n=[],r="",i=[],o=[],a=[];t.next();){var u=t.get(),s=u.curr;u.next,!r.length&&s.isWord()?r=s.value:s.isSymbol("(")?(a.length&&o.push(s.value),a.push(s)):s.isSymbol(")")?(a.pop(),a.length?o.push(s.value):o.length&&(i.push(o.join("")),o=[])):s.isSymbol(",")?a.length?(i.push(o.join("")),o=[]):(o.length&&(i.push(o.join("")),o=[]),r&&(n.push({name:r,args:i}),r="",i=[],o=[])):o.push(s.value)}return r&&n.push({name:r,args:i}),n.filter((function(e,t,n){return n.findIndex((function(t){return t.name===e.name&&e.args.join("")==t.args.join("")}))===t}))}function Zn(e){return function e(t,n){for(var r=[],i=[],o=n&&n.type||"",a=[];t.next();){var u=t.get(),s=(u.prev,u.curr),c=u.next,l=!c||s.isSymbol("}");if("block"===o&&l){c||!r.length||s.isSymbol("}")||(r[r.length-1].value+=";"+s.value),n.value=r;break}if(s.isSymbol("{")&&i.length&&!a.length){if("continue"===function(){var n=Vn(i);if(!n.length)return"continue";var o=e(t,{type:"block",name:"unkown",value:[]});n.forEach((function(e){var t=Object.assign({},o,{name:e.name,args:e.args});r.push(t)})),i=[]}())continue}else if(s.isSymbol(":")&&i.length&&!a.length){var f=Yn(i);r.push(qn(t,{type:"statement",name:f,value:""})),"block"==o&&(n.value=r),i=[]}else s.isSymbol(";")?r.length&&i.length&&(r[r.length-1].value+=";"+Yn(i),i=[]):(s.isSymbol("(")&&a.push(s),s.isSymbol(")")&&a.pop(),i.push(s))}return r.length&&"block"==o&&(n.value=r),o?n:r}(S(B(e)))}function Gn(e,t){if("fill"===e.name){var n=t.get_rgba_color(e.value),r=n.r,i=n.g,o=n.b,a=n.a;return{type:"statement",value:"\ncolor = vec4(".concat(Jn(r/255),", ").concat(Jn(i/255),", ").concat(Jn(o/255),", ").concat(Jn(a),");\n")}}return"grid"==e.name?{type:"grid",value:e.value}:{type:"statement",value:""}}function Jn(e){return String(e).includes(".")?e:e+".0"}function Kn(e,t){var n=Zn(e),r=[],i={x:1,y:1};return n.forEach((function(e){if("statement"===e.type){var n=Gn(e,t);"statement"==n.type&&r.push(n.value),"grid"===n.type&&(o=n.value,a=String(o+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map((function(e){return parseInt(e)})),u=P(a,2),s=u[0],c=u[1],l=void 0===c?s:c,(!s||s<1)&&(s=1),(!l||l<1)&&(l=1),i={x:s,y:l})}else"block"===e.type&&r.push(function(e,t){if("match"===e.name){var n=e.args[0],r=[];return e.value.forEach((function(e){var n=Gn(e,t);"statement"==n.type&&r.push(n.value)})),"\n      if (".concat(n,") {\n        ").concat(r.join(""),"\n      }\n    ")}return""}(e,t));var o,a,u,s,c,l})),function(e,t){return"\n    vec3 mapping(vec2 uv, vec2 grid) {\n      vec2 _grid = 1.0/grid;\n      float x = ceil(uv.x/_grid.x);\n      float y = ceil(grid.y - uv.y/_grid.y);\n      float i = x + (y - 1.0) * y;\n      return vec3(x, y, i);\n    }\n    vec4 getColor(float x, float y, float i, float I, float X, float Y) {\n      vec4 color = vec4(0, 0, 0, 0);\n      ".concat(e,"\n      return color;\n    }\n    void main() {\n      vec2 uv = gl_FragCoord.xy/u_resolution.xy;\n      vec2 grid = vec2(").concat(t.x,", ").concat(t.y,");\n      vec3 p = mapping(uv, grid);\n      FragColor = getColor(p.x, p.y, p.z, grid.x * grid.y, grid.x, grid.y);\n    }\n  ")}(r.join(""),i)}var Qn=ve();function er(e){var t=jt.get(e);if(t)return Promise.resolve(t);var n=Qn("css-doodle-paint"),r=function(e,t){return(t=se(t)).includes("paint(")||(t="\n      paint(ctx, {width, height}, props) {\n        ".concat(t,"\n      }\n    ")),"\n    registerPaint('".concat(e,"', class {\n      ").concat(t,"\n    })\n  ")}(n,e),i=new Blob([r],{type:"text/javascript"});try{CSS.paintWorklet&&CSS.paintWorklet.addModule(URL.createObjectURL(i))}catch(o){}return Promise.resolve(jt.set(e,"paint(".concat(n,")")))}function tr(e,t,n,r){return new Promise((function(i,o){var a="data:image/svg+xml;utf8,".concat(encodeURIComponent(e));function u(){var e=new Image;e.crossOrigin="anonymous",e.src=a,e.onload=function(){var u=document.createElement("canvas"),s=u.getContext("2d"),c=window.devicePixelRatio||1;1!=r&&(c=1),u.width=t*c,u.height=n*c,s.drawImage(e,0,0,u.width,u.height);try{u.toBlob((function(e){i({blob:e,source:a,url:URL.createObjectURL(e)})}))}catch(l){o(l)}}}ue()?ae(a,u,200):u()}))}var nr=globalThis,rr=Math,ir=[],or=rr.pow(256,6),ar=rr.pow(2,52),ur=2*ar;function sr(e,t,n){var r=[],i=fr(function e(t,n){var r,i=[],o=typeof t;if(n&&"object"==o)for(r in t)try{i.push(e(t[r],n-1))}catch(a){}return i.length?i:"string"==o?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,vr(ir)]:null==e?function(){try{var e;return e=new Uint8Array(256),(nr.crypto||nr.msCrypto).getRandomValues(e),vr(e)}catch(r){var t=nr.navigator,n=t&&t.plugins;return[+new Date,nr,n,nr.screen,vr(ir)]}}():e,3),r),o=new cr(r),a=function(){for(var e=o.g(6),t=or,n=0;e<ar;)e=256*(e+n),t*=256,n=o.g(1);for(;e>=ur;)e/=2,t/=2,n>>>=1;return(e+n)/t};return a.int32=function(){return 0|o.g(4)},a.quick=function(){return o.g(4)/4294967296},a.double=a,fr(vr(o.S),ir),(t.pass||n||function(e,t,n,r){return r&&(r.S&&lr(r,o),e.state=function(){return lr(o,{})}),n?(rr.random=e,t):e})(a,i,"global"in t?t.global:this==rr,t.state)}function cr(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);i<256;)a[i]=i++;for(i=0;i<256;i++)a[i]=a[o=255&o+e[i%n]+(t=a[i])],a[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,a=r.S;e--;)t=a[i=255&i+1],n=256*n+a[255&(a[i]=a[o=255&o+t])+(a[o]=t)];return r.i=i,r.j=o,n})(256)}function lr(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function fr(e,t){for(var n,r=e+"",i=0;i<r.length;)t[255&i]=255&(n^=19*t[255&i])+r.charCodeAt(i++);return vr(t)}function vr(e){return String.fromCharCode.apply(0,e)}function hr(e){if("undefined"==typeof getComputedStyle)return"";var t={};if(e.computedStyleMap){var n,r=O(e.computedStyleMap());try{for(r.s();!(n=r.n()).done;){var i=P(n.value,2),o=i[0],a=i[1];o.startsWith("--")&&(t[o]=a[0][0])}}catch(_r){r.e(_r)}finally{r.f()}}else{var u,s=getComputedStyle(e),c=O(s);try{for(c.s();!(u=c.n()).done;){var l=u.value;l.startsWith("--")&&(t[l]=s.getPropertyValue(l))}}catch(_r){c.e(_r)}finally{c.f()}}return function(e){for(var t=[],n=0,r=Object.entries(e);n<r.length;n++){var i=P(r[n],2),o=i[0],a=i[1];t.push(o+":"+a)}return t.join(";")}(t)}function pr(e,t){var n,r,i,o,a,u,s,c=e.querySelector("#defs");return c?(c.style.color=t,n=getComputedStyle(c).color,r=n.replace(/rgba?\((.+)\)/,(function(e,t){return t})).split(/,\s*/),i=P(r,4),o=i[0],a=i[1],u=i[2],s=i[3],{r:o,g:a,b:u,a:void 0===s?1:s}):{r:0,g:0,b:0,a:1}}if(fr(rr.random(),ir),"undefined"!=typeof customElements){var dr=function(e){k(n,e);var t=C(n);function n(){var e;return R(this,n),(e=t.call(this)).doodle=e.attachShadow({mode:"open"}),e.extra={get_variable:function(t){return function(e,t){return"undefined"==typeof getComputedStyle?"":getComputedStyle(e).getPropertyValue(t).trim().replace(/^\(|\)$/g,"")}(_(e),t)},get_rgba_color:function(t){return pr(e.shadowRoot,t)}},e}return M(n,[{key:"connectedCallback",value:function(e){var t=this;this.innerHTML?this.load(e):setTimeout((function(){return t.load(e)}))}},{key:"update",value:function(e){var t=this;jt.clear();var n=this.get_use();e||(e=se(this.innerHTML)),this.innerHTML=e,this.grid_size||(this.grid_size=this.get_grid());var r=this.grid_size,i=r.x,o=r.y,a=r.z,u=this.generate(tt(n+e,this.extra));if(!this.shadowRoot.innerHTML)return Object.assign(this.grid_size,u.grid),this.build_grid(u,u.grid);if(u.grid){var s=u.grid,c=s.x,l=s.y,f=s.z;if(i!==c||o!==l||a!==f)return Object.assign(this.grid_size,u.grid),this.build_grid(u,u.grid);Object.assign(this.grid_size,u.grid)}else{var v=this.get_grid(),h=v.x,p=v.y,d=v.z;if(i!==h||o!==p||a!==d)return Object.assign(this.grid_size,v),this.build_grid(this.generate(tt(n+e,this.extra)),v)}var m=this.replace(u);this.set_content(".style-keyframes",m(u.styles.keyframes)),u.props.has_animation&&(this.set_content(".style-cells",""),this.set_content(".style-container","")),setTimeout((function(){t.set_content(".style-container",m(gr(t.grid_size)+u.styles.host+u.styles.container)),t.set_content(".style-cells",m(u.styles.cells))}))}},{key:"grid",get:function(){return Object.assign({},this.grid_size)},set:function(e){this.attr("grid",e),this.connectedCallback(!0)}},{key:"seed",get:function(){return this._seed_value},set:function(e){this.attr("seed",e),this.connectedCallback(!0)}},{key:"use",get:function(){return this.attr("use")},set:function(e){this.attr("use",e),this.connectedCallback(!0)}},{key:"attributeChangedCallback",value:function(e,t,n){if(t==n)return!1;["grid","use","seed"].includes(e)&&!K(t)&&(this[e]=n)}},{key:"get_grid",value:function(){return nt(this.attr("grid"))}},{key:"get_use",value:function(){var e=this.attr("use")||"";return e&&(e="@use:".concat(e,";")),e}},{key:"attr",value:function(e,t){return 1===arguments.length?this.getAttribute(e):2===arguments.length?(this.setAttribute(e,t),t):void 0}},{key:"generate",value:function(e){var t=this.get_grid(),n=this.attr("seed")||this.attr("data-seed");K(n)&&(n=Date.now()),n=String(n),this._seed_value=n;var r=this.random=sr(n);return this.compiled=Dn(e,t,r)}},{key:"doodle_to_image",value:function(e,t,n){"function"==typeof t&&(n=t,t=null);var r=tt(e=":doodle { width:100%;height:100% }"+e,this.extra),i=nt({}),o=Dn(r,i,this.random),a=o.grid?o.grid:i,u=o.styles,s=u.keyframes,c=u.host,l=u.container,f=u.cells,v=this.replace(o),h=br(a),p=t&&t.width&&t.height?'width="'.concat(t.width,'" height="').concat(t.height,'"'):"";v("\n        <svg ".concat(p,' xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">\n          <foreignObject width="100%" height="100%">\n            <div class="host" xmlns="http://www.w3.org/1999/xhtml">\n              <style>\n                ').concat(mr(),"\n                ").concat(gr(a),"\n                ").concat(c,"\n                ").concat(l,"\n                ").concat(f,"\n                ").concat(s,'\n              </style>\n              <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0; height:0"></svg>\n              ').concat(h,"\n            </div>\n          </foreignObject>\n        </svg>\n      ")).then((function(e){var t="data:image/svg+xml;base64,".concat(window.btoa(unescape(encodeURIComponent(e))));ue()&&ae(t),n(t)}))}},{key:"pattern_to_image",value:function(e,t){var n=e.code,r=e.cell,i=Kn(n,this.extra);this.shader_to_image({shader:i,cell:r},t)}},{key:"canvas_to_image",value:function(e,t){er(e.code).then(t)}},{key:"shader_to_image",value:function(e,t){var n=this,r=e.shader,i=e.cell,o=function(e){for(var t,n,r=S(ot(B(e))),i=[],o=[],a={textures:[]};r.next();){var u=r.get(),s=u.curr,c=u.next;if(s.isSymbol("{")){if(i.length)o.push(s);else{var l=at(o);rt(l)?(t=l,o=[]):o.push(s)}i.push("{")}else if(s.isSymbol("}"))if(i.pop(),!i.length&&t){var f=at(o);t&&f.length&&(t.startsWith("texture")?a.textures.push({name:t,value:f}):a[t]=f,o=[]),t=null}else o.push(s);else ee(n)||n==s.pos[1]||(o.push(it()),n=null),s.isWord()&&s.value.startsWith("#")&&(o.push(it()),n=c.pos[1]),o.push(s)}return ee(a.fragment)?{fragment:at(o),textures:[]}:a}(r),a=this.doodle.getElementById(i),u=a&&a.getBoundingClientRect()||{width:0,height:0},s=u.width,c=u.height,l=window.devicePixelRatio||1;if(o.textures.length){var f=o.textures.map((function(e){return new Promise((function(t){n.doodle_to_image(e.value,{width:s,height:c},(function(n){var r=new Image;r.width=s*l,r.height=c*l,r.onload=function(){return t({name:e.name,value:r})},r.src=n}))}))}));Promise.all(f).then((function(e){o.textures=e,Fn(o,s,c).then(t)}))}else Fn(o,s,c).then(t)}},{key:"load",value:function(e){var t=this,n=tt(this.get_use()+se(this.innerHTML),this.extra),r=this.generate(n);e||this.hasAttribute("click-to-update")&&this.addEventListener("click",(function(e){return t.update()})),this.grid_size=r.grid?r.grid:this.get_grid(),this.build_grid(r,this.grid_size)}},{key:"replace",value:function(e){var t=this,n=e.doodles,r=e.shaders,i=e.canvas,o=e.pattern,a=Object.keys(n),u=Object.keys(r),s=Object.keys(i),c=Object.keys(o),l=a.length+s.length+u.length+c.length;return function(e){if(!l)return Promise.resolve(e);var f=[].concat(a.map((function(r){return e.includes(r)?new Promise((function(e){t.doodle_to_image(n[r],(function(t){return e({id:r,value:t})}))})):Promise.resolve("")})),u.map((function(n){return e.includes(n)?new Promise((function(e){t.shader_to_image(r[n],(function(t){return e({id:n,value:t})}))})):Promise.resolve("")})),s.map((function(n){return e.includes(n)?new Promise((function(e){t.canvas_to_image(i[n],(function(t){return e({id:n,value:t})}))})):Promise.resolve("")})),c.map((function(n){return e.includes(n)?new Promise((function(e){t.pattern_to_image(o[n],(function(t){return e({id:n,value:t})}))})):Promise.resolve("")})));return Promise.all(f).then((function(t){return e.replaceAll?t.forEach((function(t){var n=t.id,r=t.value;e=e.replaceAll("${"+n+"}",/^canvas/.test(n)?r:"url(".concat(r,")"))})):t.forEach((function(t){var n=t.id,r=t.value;e=e.replace("${"+n+"}",/^canvas/.test(n)?r:"url(".concat(r,")"))})),e}))}}},{key:"build_grid",value:function(e,t){var n=this,r=e.props,i=r.has_transition,o=r.has_animation,a=i||o,u=e.styles,s=u.keyframes,c=u.host,l=u.container,f=u.cells,v=gr(t)+c+l,h=a?"":f,p=e.uniforms,d=this.replace(e);this.doodle.innerHTML="\n        <style>".concat(mr(),'</style>\n        <style class="style-keyframes">').concat(s,'</style>\n        <style class="style-container">').concat(v,'</style>\n        <style class="style-cells">').concat(h,'</style>\n        <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0;height:0"></svg>\n        ').concat(br(t),"\n      "),this.set_content(".style-container",d(v)),a?setTimeout((function(){n.set_content(".style-cells",d(f))}),50):this.set_content(".style-cells",d(f)),p.time&&this.register_uniform_time(),p.mousex||p.mousey?this.register_uniform_mouse(p):this.remove_uniform_mouse(),p.width||p.height?this.register_uniform_resolution(p):this.remove_uniform_resolution()}},{key:"register_uniform_mouse",value:function(e){var t=this;if(!this.uniform_mouse_callback){var n=pn.uniform_mousex,r=pn.uniform_mousey;this.uniform_mouse_callback=function(i){var o=i.detail||i;e.mousex&&t.style.setProperty("--"+n.name,o.offsetX),e.mousey&&t.style.setProperty("--"+r.name,o.offsetY)},this.addEventListener("pointermove",this.uniform_mouse_callback);var i=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(i)}}},{key:"remove_uniform_mouse",value:function(){if(this.uniform_mouse_callback){var e=pn.uniform_mousex,t=pn.uniform_mousey;this.style.removeProperty("--"+e.name),this.style.removeProperty("--"+t.name),this.removeEventListener("pointermove",this.uniform_mouse_callback),this.uniform_mouse_callback=null}}},{key:"register_uniform_resolution",value:function(e){var t=this;if(!this.uniform_resolution_observer){var n=pn.uniform_width,r=pn.uniform_height,i=function(){var i=t.getBoundingClientRect();e.width&&t.style.setProperty("--"+n.name,i.width),e.height&&t.style.setProperty("--"+r.name,i.height)};i(),this.uniform_resolution_observer=new ResizeObserver((function(e){var t,n=O(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;(r.contentBoxSize||r.contentRect)&&i()}}catch(_r){n.e(_r)}finally{n.f()}})),this.uniform_resolution_observer.observe(this)}}},{key:"remove_uniform_resolution",value:function(){if(this.uniform_resolution_observer){var e=pn.uniform_width,t=pn.uniform_height;this.style.removeProperty("--"+e.name),this.style.removeProperty("--"+t.name),this.uniform_resolution_observer.unobserve(this),this.uniform_resolution_observer=null}}},{key:"register_uniform_time",value:function(){if(!window.CSS||!window.CSS.registerProperty)return!1;if(!this.is_uniform_time_registered){var e=pn.uniform_time;try{CSS.registerProperty({name:"--"+e.name,syntax:"<number>",initialValue:0,inherits:!0})}catch(t){}this.is_uniform_time_registered=!0}}},{key:"export",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.scale,r=t.name,i=t.download,o=t.detail;return new Promise((function(t,a){var u=hr(e),s=e.doodle.innerHTML,c=e.getBoundingClientRect(),l=c.width,f=c.height,v=l*(n=parseInt(n)||1),h=f*n,p='\n          <svg xmlns="http://www.w3.org/2000/svg"\n            preserveAspectRatio="none"\n            viewBox="0 0 '.concat(l," ").concat(f,'"\n            ').concat(ue()?"":'width="'.concat(v,'px" height="').concat(h,'px"'),'\n          >\n            <foreignObject width="100%" height="100%">\n              <div\n                class="host"\n                xmlns="http://www.w3.org/1999/xhtml"\n                style="width: ').concat(l,"px; height: ").concat(f,'px; "\n              >\n                <style>.host { ').concat(ce(u)," }</style>\n                ").concat(s,"\n              </div>\n            </foreignObject>\n          </svg>\n        ");i||o?tr(p,v,h,n).then((function(e){var n=e.source,o=e.url,a=e.blob;if(t({width:v,height:h,svg:p,blob:a,source:n}),i){var u=document.createElement("a");u.download=oe(r),u.href=o,u.click()}})).catch((function(e){a(e)})):t({width:v,height:h,svg:p})}))}},{key:"set_content",value:function(e,t){var n=this;if(t instanceof Promise)t.then((function(t){n.set_content(e,t)}));else{var r=this.shadowRoot.querySelector(e);r&&(r.styleSheet?r.styleSheet.cssText=t:r.innerHTML=t)}}}],[{key:"observedAttributes",get:function(){return["grid","use","seed"]}}]),n}(j(HTMLElement));customElements.get("css-doodle")||customElements.define("css-doodle",dr)}function mr(){var e=pn.uniform_time,t=wn(/grid/).map((function(e){return"".concat(e,": inherit;")})).join("");return"\n    * {\n      box-sizing: border-box\n    }\n    *::after, *::before {\n      box-sizing: inherit\n    }\n    :host, .host {\n      display: block;\n      visibility: visible;\n      width: auto;\n      height: auto;\n      --".concat(e.name,": 0\n    }\n    :host([hidden]), .host[hidden] {\n      display: none\n    }\n    .container {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      display: grid;\n      ").concat(t,"\n    }\n    cell:empty {\n      position: relative;\n      line-height: 1;\n      display: grid;\n      place-items: center\n    }\n    svg {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n    }\n  ")}function gr(e){var t=e||{},n=t.x,r=t.y;return"\n    :host, .host {\n      grid-template-rows: repeat(".concat(r,", 1fr);\n      grid-template-columns: repeat(").concat(n,", 1fr);\n    }\n  ")}function yr(e,t,n){var r=document.createElement("cell");return r.id=re(e,t,n),r}function br(e){var t=e||{},n=t.x,r=t.y,i=t.z,o=document.createElement("grid"),a=document.createDocumentFragment();if(1==i)for(var u=1;u<=r;++u)for(var s=1;s<=n;++s)a.appendChild(yr(s,u,1));else{for(var c=null,l=1;l<=i;++l){var f=yr(1,1,l);(c||a).appendChild(f),c=f}c=null}return o.className="container",o.appendChild(a),o.outerHTML}var xr=fe((function(e){var t=document.createElement("css-doodle");return t.update&&t.update(e),t}));e.CSSDoodle=xr,Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);
//# sourceMappingURL=3bad7c62-236bb6bd55c6b44f3237.js.map